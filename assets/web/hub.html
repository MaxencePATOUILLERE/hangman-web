<!DOCTYPE html>
<html>
<head>
    <title>Hangman</title>
    <link href="http://localhost:8080/web/css/hub.css" rel="stylesheet">
</head>
<body>
<!-- websockets.html -->
<div id="block_HangmanUs">
    <h1 id="HANGMAN_US">hAngmAn us</h1>
</div>
<div id="status_block">
    <p id="status"></p>
    <img id="connect_img" src="">
</div>
<div id="PlayerBlock">
    <p id="beforeplayer">Connected with: </p>
    <p id="playerList"></p>
</div>
<div id="adminFields">
    <form method="POST">
        <div id="selectblock">
            <select id="difficulty">
                <option value="">Choose Difficulty</option>
                <option value="easy">Easy</option>
                <option value="medium">Medium</option>
                <option value="hard">Hard</option>
            </select>
        </div>
        <div id="gamemode">
            <button id="solobutton" onclick="sendSolo()">Solo</button>
            <button id="multibutton" onclick="sendMulti()" action="multi">Multi</button>
        </div>
    </form>
</div>
<script>
    var playerList = document.getElementById("playerList");
    var adminF = document.getElementById("adminFields");
    var socket = new WebSocket("ws://localhost:8080/ws");
    var soloButton = document.getElementById("solobutton");
    var multiButton = document.getElementById("multibutton");

    socket.onopen = function () {
        console.log("Status: Connected\n");
        document.getElementById("status").innerHTML = "Connected";
        document.getElementById("connect_img").src = "http://localhost:8080/web/images/connected.png";
        socket.send(": AskInfoSend");
    };

    socket.onclose = function(){
        console.log("Status: disconected\n");
        socket.close();
        document.getElementById("status").innerHTML = "Disconnected";
        document.getElementById("connect_img").src = "http://localhost:8080/web/images/unconnected.png";
    };

    socket.onmessage = function (e) {
        var obj = JSON.parse(e.data);
        if (obj.Type == "redirect"){
            document.location.href="/"+obj.Redirect;
        }else if (obj.Type == "datas")  {
            if (!obj.Admin){
                adminF.style.visibility = "hidden";
            }
            playerList.innerHTML = obj.PlayerList;
        }
    };

    function sendSolo() {
        //socket.send(document.getElementById("difficulty").value);
        socket.send(JSON.stringify({"Difficulty":document.getElementById("difficulty").value, "Mode":"solo"}))
    }

    function sendMulti() {
        //socket.send(document.getElementById("difficulty").value);
        socket.send(JSON.stringify({"Difficulty":document.getElementById("difficulty").value, "Mode":"multi"}))
    }
</script>
</body>
</html>